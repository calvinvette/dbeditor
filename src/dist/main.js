!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([,function(e,t,n){"use strict";n.r(t);var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{ch:e.ch+t,line:e.line+n}},a=function(e){var t=e.getCursor().line;return e.getLine(t)},o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return{ch:e.ch+t.ch>=0?e.ch+t.ch:0,line:e.line+t.line>=0?e.line+t.line:0}},{ch:0,line:0})},i=function(e){return function(t){t.execCommand(e)}},c=i("goLineRight"),l=i("goLineLeft"),u=i("goLineDown"),s=i("goLineUp"),d=i("openLine"),f=i("delLineLeft"),p=i("goWordRight"),g=i("goWordLeft"),h=i("delWrappedLineRight");function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $={"Ctrl-O":function(e){var t=a(e);[c,d,u].forEach(function(t){return t(e)}),e.replaceSelection(t.match(/^\s*/)[0])},"Shift-Ctrl-O":function(e){var t=a(e);[l,d].forEach(function(t){return t(e)}),e.replaceSelection(t.match(/^\s*/)[0])},"Alt-Right":p,"Alt-Left":g,"Ctrl-L":h,"Ctrl-H":function(e){var t=a(e);f(e),e.replaceSelection(t.match(/^\s*/)[0])},"Ctrl-K":function(e){var t=e.getCursor();e.getRange(t,r(t,1)).match(/[a-zA-Z0-9_]/)&&p(e);var n=e.getCursor();g(e);var a=e.getCursor();e.setCursor(t),e.replaceRange("",a,n)},"Ctrl-U":function(e){var t=e.listSelections(),n=t.map(function(t){var n=t.head;return e.getLine(n.line)});[c,d,u].forEach(function(t){return t(e)}),e.replaceSelections(n);var a=t.map(function(e,t){var n=e.head,a=e.anchor;return{head:r(n,0,t+1),anchor:r(a,0,t+1)}});e.setSelections(a)},"Shift-Ctrl-U":function(e){var t=e.listSelections(),n=t.map(function(t){var n=t.head;return e.getLine(n.line)});[l,d].forEach(function(t){return t(e)}),e.replaceSelections(n);var a=t.map(function(e,t){var n=e.head,a=e.anchor;return{head:r(n,0,t),anchor:r(a,0,t)}});e.setSelections(a)}};function v(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var F,w={sel:"select(${*cols})",gb:"groupBy(${*cols})",ob:"orderBy(${*cols, ascending})",pb:"partitionBy(${*cols})",fil:"filter(${condition})",fna:"fillna(${value})",wc:"withColumn(${colName, col})",wcr:"withColumnRenamed(${existing, new})",jo:"join(${other, on, how})",un:"union(${other})",dp:"display(${df_or_fig})",dph:"displayHTML(${html})",sh:"show(${nrows, truncate})",ps:"printSchema()",sam:"sample(${withReplacement, fraction, seed})",samb:"sampleBy(${col, fractions, seed=None})",st:"subtract(${other})",dt:"distinct()",dr:"drop(${*cols})",drn:"dropna(${how, thresh, subset})",drd:"dropDuplicates(${subset})",tpd:"toPandas()",al:"alias(${alias})",ca:"cast(${dataType})",at:"astype(dataType)",ow:"otherwise(${value})",ew:"endswith(${other})",ss:"startswith(${other})",isn:"isNull()",isnn:"isNotNull()",isi:"isin(${*cols})",btw:"between(${lower, upper})",col:"F.col(${col})",lit:"F.lit(${col})",std:"F.stddev(${col})",sumd:"F.sumDistinct(${col})",len:"F.length(${col})",rnd:"F.round(${col, scale})",cnt:"F.count(${col})",cntd:"F.countDistinct(${col})",uxt:"F.unix_timestamp(${timestamp, format})",up:"F.upper(${col})",low:"F.lower(${col})",tr:"F.trim(${col})",ltr:"F.ltrim(${col})",rtr:"F.rtrim(${col})",sst:"F.substring(${str, pos, len})",rr:"F.regexp_replace(${str, pattern, replacement})",rep:"F.repeat(${col, n})",rev:"F.reverse(${col})",todt:"F.to_date(${col})",dtad:"F.date_add(${date})",dtsb:"F.date_sub(${date})",dtfmt:"F.date_format(${date, format})",dtdf:"F.datediff(${end, start})",sec:"F.second(${col})",epl:"F.explode(${col})",srt:"spark.read.table(${tableName})",src:"spark.read.csv(${path})",srp:"spark.read.parquet(${path})",wcsv:"write.csv(${path})",wp:"write.parquet(${path})",wop:"write.mode('overwrite').parquet(${path})",wap:"write.mode('append').parquet(${path})",wep:"write.mode('error').parquet(${path})",wip:"write.mode('ignore').parquet(${path})",ag:"agg(${*exprs})",agcnt:"agg(F.count(${col}))",agcntd:"agg(F.countDistinct(${col}))",agsum:"agg(F.sum(${col}))",agsumd:"agg(F.sumDistinct(${col}))",agmn:"agg(F.mean(${col}))",agavg:"agg(F.avg(${col}))",agmin:"agg(F.min(${col}))",agmax:"agg(F.max(${col}))",agcnta:"agg(F.count('${col}').alias('${col}_cnt'))",agcntda:"agg(F.countDistinct('${col}').alias('${col}_cntd'))",agsuma:"agg(F.sum('${col}').alias('${col}_sum'))",agsumda:"agg(F.sumDistinct('${col}').alias('${col}_sumd'))",agmna:"agg(F.mean('${col}').alias('${col}_mean'))",agavga:"agg(F.ave('${col}').alias('${col}_avg'))",agmina:"agg(F.min('${col}').alias('${col}_min'))",agmaxa:"agg(F.max('${col}').alias('${col}_max'))",dwg:"dbutils.widgets.get(${varName})",dnr:"dbutils.notebook.run(${notebookPath})",dne:"dbutils.notebook.exit(${value})",pypi:"dbutils.library.installPyPI(${packageName})",udf:"@F.udf(${type})",udfstr:"@F.udf(T.StringType())",udfbl:"@F.udf(T.BooleanType())",udfsht:"@F.udf(T.ShortType())",udfint:"@F.udf(T.IntegerType())",udflong:"@F.udf(T.LongType())",udfflt:"@F.udf(T.FloatType())",udfdbl:"@F.udf(T.DoubleType())",udfarr:"@F.udf(T.ArrayType(${dataType}))",scs:"sqlContext.sql()",ftw:"from pyspark.sql import functions as F, types as T, window as W",shcnt:"select(F.count(${col})).show()"},b=function(e){var t=function(e){var t=e.getCursor();return e.getLine(t.line).slice(0,t.ch)}(e).match(/[^a-zA-Z0-9_]?([a-zA-Z0-9_]+)$/),n=t?t[1]:"";if(n&&n in w){var a=w[n],i=e.listSelections(),c=i.map(function(e){var t=e.anchor,r=e.head;return{anchor:t,head:{line:r.line,ch:r.ch-n.length}}}),l=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=t.match(/\$\{([^{}]*)\}/);if(a){var o=y(a,2),i=o[0],c=o[1],l={ch:a.index,line:0},u=r(l,c.length);return e(t.replace(i,c),[].concat(v(n),[{head:l,anchor:u}]))}return[t,n]}(a),u=y(l,2),s=u[0],d=u[1],f=i.map(function(e){return d.map(function(t){return{anchor:r(o(e.anchor,t.anchor),-n.length),head:r(o(e.head,t.head),-n.length)}})}).flat();return e.setSelections(c),e.replaceSelections(Array(i.length).fill(s)),e.setSelections(f),!0}return!1},S={jj:u,kk:s,kj:function(e){var t=e.listSelections().map(function(t){var n=t.head,r=e.getLine(n.line).match(/^\s*/)[0],a={line:n.line,ch:r.length};return{head:a,anchor:a}});e.setSelections(t)},jk:c},T=function(e){var t=(new Date).getTime(),n=t-(e.changedAt||t);if(e.changedAt=t,n<500){var a=e.getCursor(),o=e.getRange(r(a,-2),a);if(o in S){var i=e.listSelections(),c=i.map(function(e){var t=e.anchor,n=e.head;return{anchor:t,head:r(n,-2)}});e.setSelections(c),e.replaceSelections(Array(i.length).fill("")),(0,S[o])(e)}}};F=function(){var e=document.querySelector("div.is-editing div.CodeMirror");if(e){var t=e.CodeMirror;!function(e){Object.entries($).forEach(function(t){var n=m(t,2),r=n[0],a=n[1];e.options.extraKeys[r]=a})}(t),function(e){var t=e.options.extraKeys.Tab;e.options.extraKeys.Tab=function(e){return!b(e)&&t(e)}}(t),function(e){1===e._handlers.keyup.length&&e.on("keyup",T)}(t)}},document.addEventListener("mouseup",F,!1),document.addEventListener("keyup",F,!1)}]);